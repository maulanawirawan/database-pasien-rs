<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Dashboard Ruangan & Pasien</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f4f9;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
        }
        .list-ruangan {
            max-width: 800px;
            margin: 20px auto;
            background: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow:0 2px 4px rgba(0,0,0,0.2);
        }
        .ruangan-item {
            margin-bottom: 20px;
            border-bottom:1px solid #ccc;
            padding-bottom:10px;
        }
        .ruangan-header {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .pasien-list {
            margin-left: 20px;
        }
        .pasien-item {
            margin-bottom: 10px;
        }
        .sensor-data {
            margin-left: 20px;
            font-size: 14px;
        }
        .sensor-data p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>Dashboard Ruangan & Pasien</h1>
    <div class="list-ruangan" id="list-ruangan">
        <h2>Daftar Ruangan dan Pasien</h2>
        <!-- Data ruangan dan pasien akan dimuat di sini -->
    </div>

    <script>
        const BASE_URL = "https://database-pasien-rssakit.vercel.app/api"; // Sesuaikan dengan URL Anda di Vercel

        function loadData() {
            fetch(`${BASE_URL}/ruangan`, {
                method: "GET"
            })
            .then(res => res.json())
            .then(data => {
                const listRuangan = document.getElementById("list-ruangan");
                listRuangan.innerHTML = "<h2>Daftar Ruangan dan Pasien</h2>";

                // data adalah objek yang berisi ruangan-ruangan
                for (let rId in data) {
                    const r = data[rId];
                    const ruanganDiv = document.createElement("div");
                    ruanganDiv.className = "ruangan-item";
                    ruanganDiv.innerHTML = `
                        <div class="ruangan-header">ID Ruangan: ${rId}, Nama: ${r.nama_ruangan}</div>
                    `;

                    // Pasien list
                    const pasienList = document.createElement("div");
                    pasienList.className = "pasien-list";

                    for (let pId in r.patients) {
                        const p = r.patients[pId];
                        const pasienDiv = document.createElement("div");
                        pasienDiv.className = "pasien-item";
                        pasienDiv.innerHTML = `
                            <strong>ID Pasien:</strong> ${pId}<br>
                            <strong>Nama:</strong> ${p.nama}<br>
                            <strong>Usia:</strong> ${p.usia}<br>
                            <strong>Diagnosa:</strong> ${p.diagnosa}<br>
                            <div class="sensor-data">
                                <strong>Data Sensor:</strong><br>
                                Loadcell: ${p.sensors.loadcell.value} ${p.sensors.loadcell.unit}<br>
                                Color Sensor: ${p.sensors.color_sensor.value} (${p.sensors.color_sensor.detail})<br>
                                Laju Infus: ${p.sensors.laju_infus.value} ${p.sensors.laju_infus.unit}<br>
                            </div>
                        `;
                        pasienList.appendChild(pasienDiv);
                    }

                    ruanganDiv.appendChild(pasienList);
                    listRuangan.appendChild(ruanganDiv);
                }
            })
            .catch(err => console.error("Terjadi kesalahan:", err));
        }

        window.onload = loadData;
    </script>
</body>
</html>
